{"ast":null,"code":"var textContain = require(\"zrender/lib/contain/text\"); // FIXME emphasis label position is not same with normal label position\n\n\nfunction adjustSingleSide(list, cx, cy, r, dir, viewWidth, viewHeight) {\n  list.sort(function (a, b) {\n    return a.y - b.y;\n  }); // 压\n\n  function shiftDown(start, end, delta, dir) {\n    for (var j = start; j < end; j++) {\n      list[j].y += delta;\n\n      if (j > start && j + 1 < end && list[j + 1].y > list[j].y + list[j].height) {\n        shiftUp(j, delta / 2);\n        return;\n      }\n    }\n\n    shiftUp(end - 1, delta / 2);\n  } // 弹\n\n\n  function shiftUp(end, delta) {\n    for (var j = end; j >= 0; j--) {\n      list[j].y -= delta;\n\n      if (j > 0 && list[j].y > list[j - 1].y + list[j - 1].height) {\n        break;\n      }\n    }\n  }\n\n  function changeX(list, isDownList, cx, cy, r, dir) {\n    var lastDeltaX = dir > 0 ? isDownList // 右侧\n    ? Number.MAX_VALUE // 下\n    : 0 // 上\n    : isDownList // 左侧\n    ? Number.MAX_VALUE // 下\n    : 0; // 上\n\n    for (var i = 0, l = list.length; i < l; i++) {\n      // Not change x for center label\n      if (list[i].position === 'center') {\n        continue;\n      }\n\n      var deltaY = Math.abs(list[i].y - cy);\n      var length = list[i].len;\n      var length2 = list[i].len2;\n      var deltaX = deltaY < r + length ? Math.sqrt((r + length + length2) * (r + length + length2) - deltaY * deltaY) : Math.abs(list[i].x - cx);\n\n      if (isDownList && deltaX >= lastDeltaX) {\n        // 右下，左下\n        deltaX = lastDeltaX - 10;\n      }\n\n      if (!isDownList && deltaX <= lastDeltaX) {\n        // 右上，左上\n        deltaX = lastDeltaX + 10;\n      }\n\n      list[i].x = cx + deltaX * dir;\n      lastDeltaX = deltaX;\n    }\n  }\n\n  var lastY = 0;\n  var delta;\n  var len = list.length;\n  var upList = [];\n  var downList = [];\n\n  for (var i = 0; i < len; i++) {\n    delta = list[i].y - lastY;\n\n    if (delta < 0) {\n      shiftDown(i, len, -delta, dir);\n    }\n\n    lastY = list[i].y + list[i].height;\n  }\n\n  if (viewHeight - lastY < 0) {\n    shiftUp(len - 1, lastY - viewHeight);\n  }\n\n  for (var i = 0; i < len; i++) {\n    if (list[i].y >= cy) {\n      downList.push(list[i]);\n    } else {\n      upList.push(list[i]);\n    }\n  }\n\n  changeX(upList, false, cx, cy, r, dir);\n  changeX(downList, true, cx, cy, r, dir);\n}\n\nfunction avoidOverlap(labelLayoutList, cx, cy, r, viewWidth, viewHeight) {\n  var leftList = [];\n  var rightList = [];\n\n  for (var i = 0; i < labelLayoutList.length; i++) {\n    if (labelLayoutList[i].x < cx) {\n      leftList.push(labelLayoutList[i]);\n    } else {\n      rightList.push(labelLayoutList[i]);\n    }\n  }\n\n  adjustSingleSide(rightList, cx, cy, r, 1, viewWidth, viewHeight);\n  adjustSingleSide(leftList, cx, cy, r, -1, viewWidth, viewHeight);\n\n  for (var i = 0; i < labelLayoutList.length; i++) {\n    var linePoints = labelLayoutList[i].linePoints;\n\n    if (linePoints) {\n      var dist = linePoints[1][0] - linePoints[2][0];\n\n      if (labelLayoutList[i].x < cx) {\n        linePoints[2][0] = labelLayoutList[i].x + 3;\n      } else {\n        linePoints[2][0] = labelLayoutList[i].x - 3;\n      }\n\n      linePoints[1][1] = linePoints[2][1] = labelLayoutList[i].y;\n      linePoints[1][0] = linePoints[2][0] + dist;\n    }\n  }\n}\n\nfunction _default(seriesModel, r, viewWidth, viewHeight) {\n  var data = seriesModel.getData();\n  var labelLayoutList = [];\n  var cx;\n  var cy;\n  var hasLabelRotate = false;\n  data.each(function (idx) {\n    var layout = data.getItemLayout(idx);\n    var itemModel = data.getItemModel(idx);\n    var labelModel = itemModel.getModel('label.normal'); // Use position in normal or emphasis\n\n    var labelPosition = labelModel.get('position') || itemModel.get('label.emphasis.position');\n    var labelLineModel = itemModel.getModel('labelLine.normal');\n    var labelLineLen = labelLineModel.get('length');\n    var labelLineLen2 = labelLineModel.get('length2');\n    var midAngle = (layout.startAngle + layout.endAngle) / 2;\n    var dx = Math.cos(midAngle);\n    var dy = Math.sin(midAngle);\n    var textX;\n    var textY;\n    var linePoints;\n    var textAlign;\n    cx = layout.cx;\n    cy = layout.cy;\n    var isLabelInside = labelPosition === 'inside' || labelPosition === 'inner';\n\n    if (labelPosition === 'center') {\n      textX = layout.cx;\n      textY = layout.cy;\n      textAlign = 'center';\n    } else {\n      var x1 = (isLabelInside ? (layout.r + layout.r0) / 2 * dx : layout.r * dx) + cx;\n      var y1 = (isLabelInside ? (layout.r + layout.r0) / 2 * dy : layout.r * dy) + cy;\n      textX = x1 + dx * 3;\n      textY = y1 + dy * 3;\n\n      if (!isLabelInside) {\n        // For roseType\n        var x2 = x1 + dx * (labelLineLen + r - layout.r);\n        var y2 = y1 + dy * (labelLineLen + r - layout.r);\n        var x3 = x2 + (dx < 0 ? -1 : 1) * labelLineLen2;\n        var y3 = y2;\n        textX = x3 + (dx < 0 ? -5 : 5);\n        textY = y3;\n        linePoints = [[x1, y1], [x2, y2], [x3, y3]];\n      }\n\n      textAlign = isLabelInside ? 'center' : dx > 0 ? 'left' : 'right';\n    }\n\n    var font = labelModel.getFont();\n    var labelRotate = labelModel.get('rotate') ? dx < 0 ? -midAngle + Math.PI : -midAngle : 0;\n    var text = seriesModel.getFormattedLabel(idx, 'normal') || data.getName(idx);\n    var textRect = textContain.getBoundingRect(text, font, textAlign, 'top');\n    hasLabelRotate = !!labelRotate;\n    layout.label = {\n      x: textX,\n      y: textY,\n      position: labelPosition,\n      height: textRect.height,\n      len: labelLineLen,\n      len2: labelLineLen2,\n      linePoints: linePoints,\n      textAlign: textAlign,\n      verticalAlign: 'middle',\n      rotation: labelRotate,\n      inside: isLabelInside\n    }; // Not layout the inside label\n\n    if (!isLabelInside) {\n      labelLayoutList.push(layout.label);\n    }\n  });\n\n  if (!hasLabelRotate && seriesModel.get('avoidLabelOverlap')) {\n    avoidOverlap(labelLayoutList, cx, cy, r, viewWidth, viewHeight);\n  }\n}\n\nmodule.exports = _default;","map":{"version":3,"sources":["/home/martin/Escritorio/Taller de Integracion/Tarea3-TallerDeIntegracion/node_modules/react-echarts/node_modules/echarts/lib/chart/pie/labelLayout.js"],"names":["textContain","require","adjustSingleSide","list","cx","cy","r","dir","viewWidth","viewHeight","sort","a","b","y","shiftDown","start","end","delta","j","height","shiftUp","changeX","isDownList","lastDeltaX","Number","MAX_VALUE","i","l","length","position","deltaY","Math","abs","len","length2","len2","deltaX","sqrt","x","lastY","upList","downList","push","avoidOverlap","labelLayoutList","leftList","rightList","linePoints","dist","_default","seriesModel","data","getData","hasLabelRotate","each","idx","layout","getItemLayout","itemModel","getItemModel","labelModel","getModel","labelPosition","get","labelLineModel","labelLineLen","labelLineLen2","midAngle","startAngle","endAngle","dx","cos","dy","sin","textX","textY","textAlign","isLabelInside","x1","r0","y1","x2","y2","x3","y3","font","getFont","labelRotate","PI","text","getFormattedLabel","getName","textRect","getBoundingRect","label","verticalAlign","rotation","inside","module","exports"],"mappings":"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","sourcesContent":["var textContain = require(\"zrender/lib/contain/text\");\n\n// FIXME emphasis label position is not same with normal label position\nfunction adjustSingleSide(list, cx, cy, r, dir, viewWidth, viewHeight) {\n  list.sort(function (a, b) {\n    return a.y - b.y;\n  }); // 压\n\n  function shiftDown(start, end, delta, dir) {\n    for (var j = start; j < end; j++) {\n      list[j].y += delta;\n\n      if (j > start && j + 1 < end && list[j + 1].y > list[j].y + list[j].height) {\n        shiftUp(j, delta / 2);\n        return;\n      }\n    }\n\n    shiftUp(end - 1, delta / 2);\n  } // 弹\n\n\n  function shiftUp(end, delta) {\n    for (var j = end; j >= 0; j--) {\n      list[j].y -= delta;\n\n      if (j > 0 && list[j].y > list[j - 1].y + list[j - 1].height) {\n        break;\n      }\n    }\n  }\n\n  function changeX(list, isDownList, cx, cy, r, dir) {\n    var lastDeltaX = dir > 0 ? isDownList // 右侧\n    ? Number.MAX_VALUE // 下\n    : 0 // 上\n    : isDownList // 左侧\n    ? Number.MAX_VALUE // 下\n    : 0; // 上\n\n    for (var i = 0, l = list.length; i < l; i++) {\n      // Not change x for center label\n      if (list[i].position === 'center') {\n        continue;\n      }\n\n      var deltaY = Math.abs(list[i].y - cy);\n      var length = list[i].len;\n      var length2 = list[i].len2;\n      var deltaX = deltaY < r + length ? Math.sqrt((r + length + length2) * (r + length + length2) - deltaY * deltaY) : Math.abs(list[i].x - cx);\n\n      if (isDownList && deltaX >= lastDeltaX) {\n        // 右下，左下\n        deltaX = lastDeltaX - 10;\n      }\n\n      if (!isDownList && deltaX <= lastDeltaX) {\n        // 右上，左上\n        deltaX = lastDeltaX + 10;\n      }\n\n      list[i].x = cx + deltaX * dir;\n      lastDeltaX = deltaX;\n    }\n  }\n\n  var lastY = 0;\n  var delta;\n  var len = list.length;\n  var upList = [];\n  var downList = [];\n\n  for (var i = 0; i < len; i++) {\n    delta = list[i].y - lastY;\n\n    if (delta < 0) {\n      shiftDown(i, len, -delta, dir);\n    }\n\n    lastY = list[i].y + list[i].height;\n  }\n\n  if (viewHeight - lastY < 0) {\n    shiftUp(len - 1, lastY - viewHeight);\n  }\n\n  for (var i = 0; i < len; i++) {\n    if (list[i].y >= cy) {\n      downList.push(list[i]);\n    } else {\n      upList.push(list[i]);\n    }\n  }\n\n  changeX(upList, false, cx, cy, r, dir);\n  changeX(downList, true, cx, cy, r, dir);\n}\n\nfunction avoidOverlap(labelLayoutList, cx, cy, r, viewWidth, viewHeight) {\n  var leftList = [];\n  var rightList = [];\n\n  for (var i = 0; i < labelLayoutList.length; i++) {\n    if (labelLayoutList[i].x < cx) {\n      leftList.push(labelLayoutList[i]);\n    } else {\n      rightList.push(labelLayoutList[i]);\n    }\n  }\n\n  adjustSingleSide(rightList, cx, cy, r, 1, viewWidth, viewHeight);\n  adjustSingleSide(leftList, cx, cy, r, -1, viewWidth, viewHeight);\n\n  for (var i = 0; i < labelLayoutList.length; i++) {\n    var linePoints = labelLayoutList[i].linePoints;\n\n    if (linePoints) {\n      var dist = linePoints[1][0] - linePoints[2][0];\n\n      if (labelLayoutList[i].x < cx) {\n        linePoints[2][0] = labelLayoutList[i].x + 3;\n      } else {\n        linePoints[2][0] = labelLayoutList[i].x - 3;\n      }\n\n      linePoints[1][1] = linePoints[2][1] = labelLayoutList[i].y;\n      linePoints[1][0] = linePoints[2][0] + dist;\n    }\n  }\n}\n\nfunction _default(seriesModel, r, viewWidth, viewHeight) {\n  var data = seriesModel.getData();\n  var labelLayoutList = [];\n  var cx;\n  var cy;\n  var hasLabelRotate = false;\n  data.each(function (idx) {\n    var layout = data.getItemLayout(idx);\n    var itemModel = data.getItemModel(idx);\n    var labelModel = itemModel.getModel('label.normal'); // Use position in normal or emphasis\n\n    var labelPosition = labelModel.get('position') || itemModel.get('label.emphasis.position');\n    var labelLineModel = itemModel.getModel('labelLine.normal');\n    var labelLineLen = labelLineModel.get('length');\n    var labelLineLen2 = labelLineModel.get('length2');\n    var midAngle = (layout.startAngle + layout.endAngle) / 2;\n    var dx = Math.cos(midAngle);\n    var dy = Math.sin(midAngle);\n    var textX;\n    var textY;\n    var linePoints;\n    var textAlign;\n    cx = layout.cx;\n    cy = layout.cy;\n    var isLabelInside = labelPosition === 'inside' || labelPosition === 'inner';\n\n    if (labelPosition === 'center') {\n      textX = layout.cx;\n      textY = layout.cy;\n      textAlign = 'center';\n    } else {\n      var x1 = (isLabelInside ? (layout.r + layout.r0) / 2 * dx : layout.r * dx) + cx;\n      var y1 = (isLabelInside ? (layout.r + layout.r0) / 2 * dy : layout.r * dy) + cy;\n      textX = x1 + dx * 3;\n      textY = y1 + dy * 3;\n\n      if (!isLabelInside) {\n        // For roseType\n        var x2 = x1 + dx * (labelLineLen + r - layout.r);\n        var y2 = y1 + dy * (labelLineLen + r - layout.r);\n        var x3 = x2 + (dx < 0 ? -1 : 1) * labelLineLen2;\n        var y3 = y2;\n        textX = x3 + (dx < 0 ? -5 : 5);\n        textY = y3;\n        linePoints = [[x1, y1], [x2, y2], [x3, y3]];\n      }\n\n      textAlign = isLabelInside ? 'center' : dx > 0 ? 'left' : 'right';\n    }\n\n    var font = labelModel.getFont();\n    var labelRotate = labelModel.get('rotate') ? dx < 0 ? -midAngle + Math.PI : -midAngle : 0;\n    var text = seriesModel.getFormattedLabel(idx, 'normal') || data.getName(idx);\n    var textRect = textContain.getBoundingRect(text, font, textAlign, 'top');\n    hasLabelRotate = !!labelRotate;\n    layout.label = {\n      x: textX,\n      y: textY,\n      position: labelPosition,\n      height: textRect.height,\n      len: labelLineLen,\n      len2: labelLineLen2,\n      linePoints: linePoints,\n      textAlign: textAlign,\n      verticalAlign: 'middle',\n      rotation: labelRotate,\n      inside: isLabelInside\n    }; // Not layout the inside label\n\n    if (!isLabelInside) {\n      labelLayoutList.push(layout.label);\n    }\n  });\n\n  if (!hasLabelRotate && seriesModel.get('avoidLabelOverlap')) {\n    avoidOverlap(labelLayoutList, cx, cy, r, viewWidth, viewHeight);\n  }\n}\n\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}